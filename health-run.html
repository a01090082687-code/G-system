<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>í—¬ìŠ¤ ëŸ° | G-SYSTEM ì˜¤ë½ì‹¤</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { background: #1e293b; min-height: 100vh; display: flex; align-items: center; justify-content: center; overflow: hidden; touch-action: manipulation; -webkit-tap-highlight-color: transparent; }
        .wrap { width: 100%; max-width: 430px; height: 100vh; max-height: 820px; position: relative; border-radius: 12px; overflow: hidden; box-shadow: 0 0 40px rgba(0,0,0,0.5); }
        #c { display: block; width: 100%; height: 100%; background: #334155; }
        .hud { position: absolute; top: 0; left: 0; right: 0; padding: 14px 16px; display: flex; justify-content: space-between; align-items: center; pointer-events: none; z-index: 5; }
        .hud span { color: #fff; font-size: 18px; font-weight: bold; font-family: sans-serif; text-shadow: 0 1px 3px rgba(0,0,0,0.8); }
        .start-screen { position: absolute; inset: 0; background: rgba(0,0,0,0.8); display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 20; padding: 24px; }
        .start-screen.hide { display: none; }
        .start-title { color: #fff; font-size: 26px; margin-bottom: 12px; text-align: center; }
        .start-desc { color: rgba(255,255,255,0.9); font-size: 14px; line-height: 1.7; text-align: center; margin-bottom: 24px; }
        .btn { background: linear-gradient(135deg, #22c55e, #16a34a); color: #fff; border: none; padding: 16px 40px; border-radius: 12px; font-size: 18px; font-weight: bold; cursor: pointer; }
        .version-info { color: rgba(255,255,255,0.6); font-size: 12px; margin-top: 14px; }
        .version-info.version-title { margin-top: 6px; margin-bottom: 6px; font-size: 13px; color: rgba(255,255,255,0.95); }
        .go-screen { position: absolute; inset: 0; background: rgba(0,0,0,0.9); display: none; flex-direction: column; align-items: center; justify-content: center; z-index: 20; padding: 24px; }
        .go-screen.show { display: flex; }
        .go-title { color: #fff; font-size: 28px; margin-bottom: 8px; font-weight: bold; }
        .go-score { color: #fbbf24; font-size: 24px; margin-bottom: 24px; font-weight: bold; }
        .arcade-back { position: absolute; top: 12px; left: 12px; z-index: 30; padding: 8px 14px; background: rgba(0,0,0,0.5); color: #fff; border-radius: 8px; font-size: 13px; font-weight: bold; text-decoration: none; }
        .arcade-back:hover { background: rgba(0,0,0,0.7); color: #fff; }
    </style>
</head>
<body>
    <div class="wrap">
        <a href="index.html" class="arcade-back">â† G-SYSTEM ì˜¤ë½ì‹¤</a>
        <canvas id="c"></canvas>
        <div class="hud">
            <span>â¤ï¸ <span id="healthEl">3</span> Â· ğŸ˜· <span id="shieldEl">0</span></span>
            <span>ì ìˆ˜: <span id="scoreEl">0</span></span>
        </div>
        <div class="start-screen" id="startScreen">
            <div class="start-title">ğŸ§ í—¬ìŠ¤ ëŸ°</div>
            <div class="version-info version-title">Ver 1.1 (Run)</div>
            <div class="start-desc"><strong>ì¥ë¥´:</strong> ì™¼ìª½ì—ì„œ ì˜¤ë¥¸ìª½ìœ¼ë¡œ ë‹¬ë¦¬ëŠ” íš¡ìŠ¤í¬ë¡¤ ëŸ°ë‹ ì•¡ì…˜.<br><strong>ì¡°ì‘:</strong> í™”ë©´ í„°ì¹˜ ì‹œ ì í”„, ê³µì¤‘ í„°ì¹˜ ì‹œ 2ë‹¨ ì í”„.<br><strong>ì¥ì• ë¬¼:</strong> ğŸ¦  ë°”ì´ëŸ¬ìŠ¤(ë°”ë‹¥/ê³µì¤‘), ğŸ’¨ ë§¤ì—° Â· ì í”„ë¡œ í”¼í•˜ì„¸ìš”.<br><strong>ì•„ì´í…œ:</strong> ğŸ˜· ë§ˆìŠ¤í¬(ë³´í˜¸ë§‰ 1íšŒ), ğŸ’Š ë¹„íƒ€ë¯¼(ì ìˆ˜).</div>
            <button class="btn" id="btnStart">ë‹¬ë¦¬ê¸° ì‹œì‘</button>
        </div>
        <div class="go-screen" id="goScreen">
            <div class="go-title">ê²Œì„ ì˜¤ë²„</div>
            <div class="go-score">ì ìˆ˜: <span id="finalScore">0</span></div>
            <button class="btn" id="btnRetry">ë‹¤ì‹œ í•˜ê¸°</button>
        </div>
    </div>
    <script>
    (function() {
        'use strict';
        var canvas = document.getElementById('c');
        var ctx = canvas ? canvas.getContext('2d') : null;
        var cw = 0, ch = 0;
        function resize() {
            if (!canvas || !canvas.parentElement) return;
            cw = canvas.parentElement.clientWidth;
            ch = canvas.parentElement.clientHeight;
            canvas.width = cw;
            canvas.height = ch;
        }
        window.addEventListener('resize', resize);
        resize();

        var animationId = null;
        var Gupaengi = 'ğŸ§';
        var PLAYER_SCREEN_X = 100;
        var PLAYER_W = 44, PLAYER_H = 40;
        var GRAVITY_UP = -0.36;
        var GRAVITY_DOWN = -0.56;
        var JUMP_VY = 14.5;
        var DOUBLE_JUMP_VY = 12;
        var RUN_SPEED_BASE = 7;
        var SPEED_INCREASE_PER_DIST = 0.0007;
        var FLOOR_Y_RATIO = 0.82;
        var GROUND_H = 24;
        var OBSTACLE_W = 34, OBSTACLE_H = 34;
        var ITEM_SIZE = 30;
        var SPAWN_INTERVAL_BASE = 280;
        var MASK_SHIELD_MAX = 2;
        var VITAMIN_SCORE = 50;
        var FPS = 60;
        var SPEED_BOOST_PER_10SEC = 0.28;

        var state = {
            run: false, score: 0, health: 3, shield: 0,
            px: PLAYER_SCREEN_X, py: 0, vy: 0,
            speed: RUN_SPEED_BASE, scrollX: 0, gameTime: 0,
            canDoubleJump: true,
            obstacles: [], items: [],
            nextSpawn: SPAWN_INTERVAL_BASE, floorY: 0
        };

        function getFloorY() { return ch * FLOOR_Y_RATIO - GROUND_H; }

        function spawnObstacle() {
            var isVirus = Math.random() < 0.6;
            var x = state.scrollX + cw + OBSTACLE_W + Math.random() * 60;
            var y = isVirus ? (Math.random() < 0.7 ? 0 : 25 + Math.random() * 40) : (30 + Math.random() * 50);
            state.obstacles.push({
                x: x, y: y, w: OBSTACLE_W, h: OBSTACLE_H,
                type: isVirus ? 'ğŸ¦ ' : 'ğŸ’¨'
            });
        }

        function spawnItem() {
            var isMask = Math.random() < 0.3;
            var x = state.scrollX + cw + ITEM_SIZE + Math.random() * 80;
            var y = Math.random() < 0.5 ? 0 : (ch * 0.2 + Math.random() * ch * 0.35);
            state.items.push({
                x: x, y: y, w: ITEM_SIZE, h: ITEM_SIZE,
                type: isMask ? 'ğŸ˜·' : 'ğŸ’Š'
            });
        }

        function overlap(pl, pr, pb, pt, ol, or_, ob, ot) {
            return pr > ol && pl < or_ && pb > ot && pt < ob;
        }

        function loop() {
            animationId = requestAnimationFrame(loop);
            if (!state.run) return;
            if (!ctx || !canvas || cw <= 0 || ch <= 0) return;

            state.gameTime++;
            state.floorY = getFloorY();
            var timeMultiplier = 1 + Math.floor(state.gameTime / (FPS * 10)) * SPEED_BOOST_PER_10SEC;
            state.speed = (RUN_SPEED_BASE + state.scrollX * SPEED_INCREASE_PER_DIST) * timeMultiplier;
            state.scrollX += state.speed * 0.16;
            state.nextSpawn -= state.speed * 0.16;

            if (state.nextSpawn <= 0) {
                state.nextSpawn = SPAWN_INTERVAL_BASE + Math.random() * 100;
                if (Math.random() < 0.72) spawnObstacle();
                if (Math.random() < 0.48) spawnItem();
            }

            var g = state.vy > 0 ? GRAVITY_UP : GRAVITY_DOWN;
            state.vy += g;
            state.py += state.vy;
            if (state.py <= 0) {
                state.py = 0;
                state.vy = 0;
                state.canDoubleJump = true;
            }

            var pl = state.px, pr = state.px + PLAYER_W;
            var pt = state.floorY - state.py - PLAYER_H, pb = state.floorY - state.py;

            for (var i = state.obstacles.length - 1; i >= 0; i--) {
                var o = state.obstacles[i];
                if (o.x + o.w < state.scrollX - 40) { state.obstacles.splice(i, 1); continue; }
                var ol = o.x - state.scrollX, or_ = ol + o.w;
                var ot = state.floorY - o.y - o.h, ob = state.floorY - o.y;
                if (!overlap(pl, pr, pb, pt, ol, or_, ob, ot)) continue;
                state.obstacles.splice(i, 1);
                if (state.shield > 0) {
                    state.shield--;
                    var sel = document.getElementById('shieldEl');
                    if (sel) sel.textContent = state.shield;
                } else {
                    state.health--;
                    var hel = document.getElementById('healthEl');
                    if (hel) hel.textContent = state.health;
                    if (state.health <= 0) {
                        state.run = false;
                        if (animationId) { cancelAnimationFrame(animationId); animationId = null; }
                        document.getElementById('finalScore').textContent = state.score;
                        document.getElementById('goScreen').classList.add('show');
                        return;
                    }
                }
            }

            for (var i = state.items.length - 1; i >= 0; i--) {
                var it = state.items[i];
                if (it.x + it.w < state.scrollX - 40) { state.items.splice(i, 1); continue; }
                var il = it.x - state.scrollX, ir = il + it.w;
                var itop = state.floorY - it.y - it.h, ibot = state.floorY - it.y;
                if (!overlap(pl, pr, pb, pt, il, ir, ibot, itop)) continue;
                state.items.splice(i, 1);
                if (it.type === 'ğŸ˜·') {
                    state.shield = Math.min(MASK_SHIELD_MAX, state.shield + 1);
                    var sel = document.getElementById('shieldEl');
                    if (sel) sel.textContent = state.shield;
                } else {
                    state.score += VITAMIN_SCORE;
                }
            }

            state.score += Math.max(0, Math.floor(state.speed * 0.25));
            var sel = document.getElementById('scoreEl');
            if (sel) sel.textContent = state.score;

            ctx.fillStyle = '#334155';
            ctx.fillRect(0, 0, cw, ch);
            var stripeW = 72;
            var off = (state.scrollX * 0.5) % (stripeW * 2);
            for (var sx = -off; sx < cw + stripeW; sx += stripeW * 2) {
                ctx.fillStyle = 'rgba(0,0,0,0.12)';
                ctx.fillRect(sx, 0, stripeW, ch);
            }
            var fy = state.floorY;
            ctx.fillStyle = '#475569';
            ctx.fillRect(0, fy, cw + 300, ch - fy + 30);
            ctx.fillStyle = '#64748b';
            ctx.fillRect(0, fy, cw + 300, 3);

            var i;
            for (i = 0; i < state.obstacles.length; i++) {
                var o = state.obstacles[i];
                var ox = o.x - state.scrollX;
                if (ox < -60 || ox > cw + 60) continue;
                var oy = fy - o.y - o.h;
                ctx.font = (o.h * 0.85) + 'px Arial';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText(o.type, ox + o.w/2, oy + o.h/2);
            }
            for (i = 0; i < state.items.length; i++) {
                var it = state.items[i];
                var ix = it.x - state.scrollX;
                if (ix < -60 || ix > cw + 60) continue;
                var iy = fy - it.y - it.h;
                ctx.font = (it.h * 0.85) + 'px Arial';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText(it.type, ix + it.w/2, iy + it.h/2);
            }

            var cx = state.px + PLAYER_W/2;
            var cy = fy - state.py - PLAYER_H/2;
            ctx.font = '40px Arial';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.fillStyle = '#1e293b';
            ctx.save();
            ctx.translate(cx, cy);
            ctx.scale(-1, 1);
            ctx.translate(-cx, -cy);
            ctx.fillText(Gupaengi, cx, cy);
            ctx.restore();
        }

        function jump() {
            if (!state.run) return;
            if (state.py <= 0) {
                state.vy = JUMP_VY;
                state.canDoubleJump = true;
            } else if (state.canDoubleJump) {
                state.vy = DOUBLE_JUMP_VY;
                state.canDoubleJump = false;
            }
        }

        function onTap(e) {
            if (e) e.preventDefault();
            if (!state.run) return;
            jump();
        }
        if (canvas) {
            canvas.addEventListener('touchstart', onTap, { passive: false });
            canvas.addEventListener('touchend', function(ev) { ev.preventDefault(); }, { passive: false });
            canvas.addEventListener('mousedown', function(e) { e.preventDefault(); onTap(e); });
            canvas.addEventListener('mouseup', function(e) { e.preventDefault(); });
        }
        document.addEventListener('keydown', function(e) {
            if (e.code === 'Space') { e.preventDefault(); onTap(); }
        });

        function startGame() {
            if (!canvas || !ctx) return;
            if (animationId) { cancelAnimationFrame(animationId); animationId = null; }
            resize();
            state.run = true;
            state.score = 0;
            state.health = 3;
            state.shield = 0;
            state.px = PLAYER_SCREEN_X;
            state.py = 0;
            state.vy = 0;
            state.speed = RUN_SPEED_BASE;
            state.scrollX = 0;
            state.gameTime = 0;
            state.canDoubleJump = true;
            state.obstacles = [];
            state.items = [];
            state.nextSpawn = SPAWN_INTERVAL_BASE;
            state.floorY = getFloorY();
            var hel = document.getElementById('healthEl');
            var sel = document.getElementById('shieldEl');
            var scoreEl = document.getElementById('scoreEl');
            if (hel) hel.textContent = '3';
            if (sel) sel.textContent = '0';
            if (scoreEl) scoreEl.textContent = '0';
            document.getElementById('startScreen').classList.add('hide');
            document.getElementById('goScreen').classList.remove('show');
            animationId = requestAnimationFrame(loop);
        }

        var btnStart = document.getElementById('btnStart');
        var btnRetry = document.getElementById('btnRetry');
        if (btnStart) btnStart.addEventListener('click', startGame);
        if (btnRetry) btnRetry.addEventListener('click', startGame);
        animationId = requestAnimationFrame(loop);
    })();
    </script>
</body>
</html>
